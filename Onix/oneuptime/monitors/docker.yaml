_id: cee6f3d2-2eab-4245-a708-cc6214ac9999
name: Docker
description: Monitors Docker Hub and container registry - container images
slug: docker-4429374524
monitorType: Custom JavaScript Code
monitoringInterval: "*/10 * * * *"  # every 10 min
defaultMonitorStatusId: 7f2ba4b8-50a9-4f65-ad5e-0ae5f08dc4e3  # Operational
criteria:
  - name: Check for critical outage
    description: This criteria checks if Docker has a critical outage
    monitorStatusId: e1aeeeb0-25d8-4915-837e-21828ece73d1  # Offline
    filterCondition: All
    filters:
      - checkOn: Result
        filterType: Contains
        value: "[OFFLINE:critical]"
    changeMonitorStatus: true
    createIncidents: true
    createAlerts: false
    incidents:
      - title: "{{monitorName}} - Critical Outage"
        description: |
          **Status:** {{result.description}}

          **Incident:** {{result.data.incident.name}}
          - Impact: {{result.data.incident.impact}}
          - Status: {{result.data.incident.status}}
          - Link: {{result.data.incident.link}}

          **Update:** {{result.data.incident.update}}

          **Active Issues:** {{result.data.incidentCount}} incident(s), {{result.data.maintenanceCount}} maintenance(s)

          [View Status Page]({{result.url}})
        incidentSeverityId: f0eafec9-9669-4095-a33d-7a1e52661f89  # Critical
        autoResolveIncident: true
    alerts: []
  - name: Check for major outage
    description: This criteria checks if Docker has a major outage
    monitorStatusId: e1aeeeb0-25d8-4915-837e-21828ece73d1  # Offline
    filterCondition: All
    filters:
      - checkOn: Result
        filterType: Contains
        value: "[OFFLINE:major]"
    changeMonitorStatus: true
    createIncidents: true
    createAlerts: false
    incidents:
      - title: "{{monitorName}} - Major Outage"
        description: |
          **Status:** {{result.description}}

          **Incident:** {{result.data.incident.name}}
          - Impact: {{result.data.incident.impact}}
          - Status: {{result.data.incident.status}}
          - Link: {{result.data.incident.link}}

          **Update:** {{result.data.incident.update}}

          **Active Issues:** {{result.data.incidentCount}} incident(s), {{result.data.maintenanceCount}} maintenance(s)

          [View Status Page]({{result.url}})
        incidentSeverityId: 9c2903e7-920d-405e-8f0c-a603ae5cd58d  # Major
        autoResolveIncident: true
    alerts: []
  - name: Check if degraded
    description: This criteria checks if Docker is degraded
    monitorStatusId: 29dfb8f0-9298-4fba-9c7a-9532c27ecd24  # Degraded
    filterCondition: All
    filters:
      - checkOn: Result
        filterType: Contains
        value: "[DEGRADED]"
    changeMonitorStatus: true
    createIncidents: false
    createAlerts: false
  - name: Check if status check failed
    description: This criteria checks if the Docker status check script encountered an error
    monitorStatusId: 29dfb8f0-9298-4fba-9c7a-9532c27ecd24  # Degraded
    filterCondition: All
    filters:
      - checkOn: Error
        filterType: Is Not Empty
    changeMonitorStatus: true
    createIncidents: true
    createAlerts: false
    incidents:
      - title: "{{monitorName}} - Status Check Failed"
        description: The status check script encountered an error.
        incidentSeverityId: 126b94dd-03a8-4c05-9b6d-d4bbc86e778b  # Warning
        autoResolveIncident: true
    alerts: []
customCode: |
  const response = await axios.get('https://api.status.io/1.0/status/533c6539221ae15e3f000031');
  const data = response.data.result;
  const overallStatus = data.status_overall;

  // status_code: 100 = Operational, 300 = Degraded, 500 = Outage
  let status, description;
  if (overallStatus.status_code === 500) {
    status = '[OFFLINE:critical]';
    description = overallStatus.status;
  } else if (overallStatus.status_code === 300) {
    status = '[DEGRADED]';
    description = overallStatus.status;
  } else if (data.incidents && data.incidents.length > 0) {
    status = '[DEGRADED]';
    description = 'Active incident';
  } else {
    status = '[OPERATIONAL]';
    description = 'All Systems Operational';
  }

  const first = data.incidents?.[0];

  return { data: {
    status,
    title: `Docker - ${description}`,
    description,
    url: 'https://status.docker.com',
    data: {
      incidentCount: data.incidents?.length || 0,
      maintenanceCount: data.maintenance?.active?.length || 0,
      incident: first ? {
        name: first.name || 'Active incident',
        impact: 'unknown',
        status: 'active',
        link: '',
        update: first.messages?.[0]?.details?.substring(0, 300) || ''
      } : null
    }
  }};
