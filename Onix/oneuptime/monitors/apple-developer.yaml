_id: 28715547-3cc2-498f-8c45-cd7f4437a625
name: Apple Developer
description: Monitors App Store Connect, TestFlight, and Xcode Cloud - iOS app distribution
slug: apple-developer-7282997496
monitorType: Custom JavaScript Code
monitoringInterval: "*/5 * * * *"  # every 5 min
defaultMonitorStatusId: 7f2ba4b8-50a9-4f65-ad5e-0ae5f08dc4e3  # Operational
criteria:
  - name: Check for critical outage
    description: This criteria checks if Apple Developer has a critical outage
    monitorStatusId: e1aeeeb0-25d8-4915-837e-21828ece73d1  # Offline
    filterCondition: All
    filters:
      - checkOn: Result
        filterType: Contains
        value: "[OFFLINE:critical]"
    changeMonitorStatus: true
    createIncidents: true
    createAlerts: false
    incidents:
      - title: "{{monitorName}} - Critical Outage"
        description: |
          **Status:** {{result.description}}

          **Incident:** {{result.data.incident.name}}
          - Impact: {{result.data.incident.impact}}
          - Status: {{result.data.incident.status}}
          - Link: {{result.data.incident.link}}

          **Update:** {{result.data.incident.update}}

          **Active Issues:** {{result.data.incidentCount}} incident(s), {{result.data.maintenanceCount}} maintenance(s)

          [View Status Page]({{result.url}})
        incidentSeverityId: f0eafec9-9669-4095-a33d-7a1e52661f89  # Critical
        autoResolveIncident: true
    alerts: []
  - name: Check for major outage
    description: This criteria checks if Apple Developer has a major outage
    monitorStatusId: e1aeeeb0-25d8-4915-837e-21828ece73d1  # Offline
    filterCondition: All
    filters:
      - checkOn: Result
        filterType: Contains
        value: "[OFFLINE:major]"
    changeMonitorStatus: true
    createIncidents: true
    createAlerts: false
    incidents:
      - title: "{{monitorName}} - Major Outage"
        description: |
          **Status:** {{result.description}}

          **Incident:** {{result.data.incident.name}}
          - Impact: {{result.data.incident.impact}}
          - Status: {{result.data.incident.status}}
          - Link: {{result.data.incident.link}}

          **Update:** {{result.data.incident.update}}

          **Active Issues:** {{result.data.incidentCount}} incident(s), {{result.data.maintenanceCount}} maintenance(s)

          [View Status Page]({{result.url}})
        incidentSeverityId: 9c2903e7-920d-405e-8f0c-a603ae5cd58d  # Major
        autoResolveIncident: true
    alerts: []
  - name: Check if degraded
    description: This criteria checks if Apple Developer is degraded
    monitorStatusId: 29dfb8f0-9298-4fba-9c7a-9532c27ecd24  # Degraded
    filterCondition: All
    filters:
      - checkOn: Result
        filterType: Contains
        value: "[DEGRADED]"
    changeMonitorStatus: true
    createIncidents: false
    createAlerts: false
  - name: Check if status check failed
    description: This criteria checks if the Apple Developer status check script encountered an error
    monitorStatusId: 29dfb8f0-9298-4fba-9c7a-9532c27ecd24  # Degraded
    filterCondition: All
    filters:
      - checkOn: Error
        filterType: Is Not Empty
    changeMonitorStatus: true
    createIncidents: true
    createAlerts: false
    incidents:
      - title: "{{monitorName}} - Status Check Failed"
        description: The status check script encountered an error.
        incidentSeverityId: 126b94dd-03a8-4c05-9b6d-d4bbc86e778b  # Warning
        autoResolveIncident: true
    alerts: []
customCode: |
  // Apple uses JSONP format - need to strip the callback wrapper
  const response = await axios.get('https://www.apple.com/support/systemstatus/data/developer/system_status_en_US.js', {
    responseType: 'text'
  });

  // Parse JSONP - let errors propagate so Script Error criteria catches them
  const text = typeof response.data === 'string' ? response.data : String(response.data);
  // Strip JSONP wrapper: jsonCallback({...});
  const match = text.match(/jsonCallback\(([\s\S]*)\);?\s*$/);
  let data;
  if (match && match[1]) {
    data = JSON.parse(match[1]);
  } else {
    throw new Error('Invalid JSONP response format from Apple Developer status API');
  }

  // Find services with ongoing events
  const servicesWithIssues = (data.services || []).filter(service => {
    return service.events && service.events.some(event => event.eventStatus !== 'resolved');
  });

  const hasOutage = servicesWithIssues.some(s =>
    s.events.some(e => e.eventStatus !== 'resolved' && e.statusType === 'Outage')
  );
  const first = servicesWithIssues[0];
  const firstEvent = first?.events?.find(e => e.eventStatus !== 'resolved');

  let status, description;
  if (hasOutage) {
    status = '[OFFLINE:critical]';
    description = 'Service Outage';
  } else if (servicesWithIssues.length > 0) {
    status = '[DEGRADED]';
    description = 'Service Issues';
  } else {
    status = '[OPERATIONAL]';
    description = 'All Systems Operational';
  }

  return { data: {
    status,
    title: `Apple Developer - ${description}`,
    description,
    url: 'https://developer.apple.com/system-status',
    data: {
      incidentCount: servicesWithIssues.length,
      maintenanceCount: 0,
      incident: first ? {
        name: first.serviceName || 'Unknown Service',
        impact: firstEvent?.statusType || 'unknown',
        status: firstEvent?.eventStatus || 'unknown',
        link: '',
        update: (firstEvent?.message || '').substring(0, 300)
      } : null
    }
  }};
